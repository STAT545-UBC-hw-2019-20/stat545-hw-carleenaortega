---
title: 'HW05: Factor and Figure Management'
author: "Carleena Ortega"
date: "14/10/2019"
output: 
  html_document:
    toc: true
  pdf_document:
    toc: true
---

```{r}
suppressPackageStartupMessages(library(gapminder))
suppressPackageStartupMessages(library(tibble))
suppressPackageStartupMessages(library(forcats))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(knitr))
suppressPackageStartupMessages(library(kableExtra))
```



# Exercise 1: Explain the value of the here::here package

In your own words, summarize the value of the here::here package in 250 words or fewer.

# Exercise 2: Factor management

We choose the `gapminder` dataset and select `continent` as the factor to explore. The code below determines whether gapminder's continent is a factor or not; how many levels it has and what these levels are.
```{r}
class(gapminder$continent)
nlevels(gapminder$continent)
levels(gapminder$continent)

str(gapminder)
```
We now know that `continent` is a factor with 5 levels named Africa, Americas, Asia, Europe, and Oceania. We also have 1704 rows or observations as shown by the str() function.

Our next step is to filter and drop levels. We filter out Oceania and then drop the unused factor levels in continent. 

```{r}
drop_Ocn<-gapminder %>% 
  filter(continent !="Oceania") %>% 
  droplevels()

drop_Ocn$continent %>% 
  nlevels() 

drop_Ocn$continent %>% 
  levels()

str(drop_Ocn)
```

We have successfully filtered out the data from Oceania as we now have only 4 levels in continent named Africa, Americas, Asia, and Europe. The str() function also shows that we have 1680 observations, which is less than the original dataset (1704 observations).

Our next goal is to explore the effects of re-leveling a factor with the gapminder data set.

```{r}
drop_Ocn %>% 
  group_by(continent) %>% 
  mutate("max GDP"=max(gdpPercap)) %>% 
  ggplot()+
  geom_bar(aes(continent),colour="light blue", fill="light blue")+
  labs(x="Continent",y=",ax GDP ($)",title="The Max GDP of continents (Original)")+
  theme_bw()
  
```

By default, the continents are arranged alphabetically. We can use the forcats package (fct_infreq  and fct_rev() commands) to arrange the continents by frequence and in an ascending order of max (gross domestic product) GDP, respectively.

```{r}
drop_Ocn %>% 
  group_by(continent) %>% 
  mutate("max GDP"=max(gdpPercap)) %>% 
  ggplot()+
  geom_bar(aes(fct_rev(fct_infreq(continent))),colour="royal blue", fill="royal blue")+
  labs(x="Continent",y="Max GDP ($)",title="The Max GDP of continents (Reordered)")+
  theme_bw()
  
```

This is a more appealing and understandable way of presenting the max GDP of each continent compared to the first plot.

# Exercise 3: File input/output (I/O)
Task: Experiment with at least one of:


For this exercise, we will modify the `gapminder` data set to show only data from Africa in 2007. We will then export this file using write_csv().
```{r}
gm_africa2007 <-gapminder %>% 
  filter(year == 2007, continent=="Africa")

write_csv(gm_africa2007,here::here("./HW05","gm_africa2007.csv"))
```

We will now reload the exported file back into R using read_csv() and play around its factor levels

```{r}
read_csv(here::here("./HW05/gm_africa2007.csv")) %>% 
  arrange(lifeExp) %>%
  ggplot()+
  geom_point(aes(x=lifeExp,y=fct_reorder(country,lifeExp)))+
  labs(x="Country",y="Life Expectancy (years)",title="The Life Expectancy of African countries in 2007")+
  theme_bw()
```

The life expectancy of Africans in 2007 ranges from around 40 to 79 with Swaziland having the lowest life expectancy and Reunion with the highest life expectancy.

We exclude the countries with a life expectancy less than 50 years using filter() and droplevels() in the following plot:
```{r warning= FALSE}
read_csv(here::here("./HW05/gm_africa2007.csv")) %>% 
  filter(lifeExp>50) %>% 
  droplevels() %>% 
  ggplot()+
  geom_point(aes(x=lifeExp,y=fct_reorder(country,lifeExp)))+
  labs(x="Country",y="Life Expectancy (years)",title="The Life Expectancy of African countries in 2007")+
  theme_bw()
```

We have successfully exported, imported, and modified the gm_africa2007 file. Therefore, I can say that it has successfully passed being written to file and being read back in.

# Exercise 4: Visualization design

Task: Create a side-by-side plot and juxtapose your first attempt (show the original figure as-is) with a revised attempt after some time spent working on it and implementing principles of effective plotting principles. Comment and reflect on the differences.

I have chosen to revise the plot I made for HW01 Exercise 2. The code and plot are as follows:
```{r}
gapminder %>% 
  arrange(country)%>%
  filter(year == 1952) %>% 
  mutate(continent = fct_infreq(continent)) %>% 
  ggplot(aes(continent)) +
  geom_bar(aes()) +
  theme_light()
```




# Exercise 5: Writing figures to file (10%)

Task: Use ggsave() to explicitly save a plot to file. Include the exported plot as part of your repository and assignment.

Then, use ![Alt text] (/path/to/img.png) to load and embed that file into your report. You can play around with various options, such as:

Arguments of ggsave(), such as width, height, resolution or text scaling.
Various graphics devices, e.g. a vector vs. raster format.
Explicit provision of the plot object p via ggsave(..., plot = p). Show a situation in which this actually matters.
