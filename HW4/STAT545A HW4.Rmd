---
title: 'HW04: Tidy data and joins'
author: "Carleena Ortega"
date: "02/10/2019"
output: 
  html_document:
    toc: yes
    theme: yeti
---

```{r setup, include=FALSE}
suppressPackageStartupMessages(library(tidyr))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(gapminder))
suppressPackageStartupMessages(library(knitr))
suppressPackageStartupMessages(library(kableExtra))
suppressPackageStartupMessages(library(scales))
knitr::opts_chunk$set(echo = TRUE)
```

# Exercise 1: Univariate Data Reshaping
Choose *EITHER* “Univariate Option 1” or “Univariate Option 2”. 
Both of these problems have three components:

1. Putting data in wider format
2. Producing a plot of the wide data
3. Re-lengthening the wider data

### ~~Univariate Option 1~~
1. Make a tibble with one row per year, and columns for life expectancy for two or more countries.
2. Take advantage of this new data shape to scatterplot life expectancy for one country against that of another.
3. Re-lengthen the data.

### **Univariate Option 2**
1. Compute some measure of life expectancy (mean? median? min? max?) for all possible combinations of continent and year. Reshape that to have one row per year and one variable for each continent. Or the other way around: one row per continent and one variable per year.
```{r}
t1<-gapminder %>% 
  group_by(continent,year) %>% 
  select(continent,year,lifeExp) %>% 
  arrange(continent,year) %>% 
  summarize(mean_LE=mean(lifeExp))
  
t1_wide<-pivot_wider(t1,names_from="continent", values_from="mean_LE")
knitr::kable(t1_wide) %>% 
  kable_styling("striped",latex_options="basic",
    full_width=FALSE,position="center")
```

2. Is there a plot that is easier to make with the data in this shape versis the usual form? Try making such a plot!

```{r}
ggplot(t1_wide) +
  geom_jitter(aes(year,"Africa",color="Africa"))+
  geom_jitter(aes(year,"Americas", color="Americas"))+
  geom_jitter(aes(year,"Asia",color="Asia"))+
  geom_jitter(aes(year,"Europe",color="Europe"))+
  geom_jitter(aes(year,"Oceania",color="Oceania"))+
  labs(x="Year",y="Mean Life Expectancy of Each Continent",
  title="Growth of the Mean Life Expectancy of Each Continent (Reshaped)")+
  theme_light()
```

```{r}
ggplot(t1) +
  geom_point(aes(year,mean_LE,color=continent))+
  geom_line(aes(year,mean_LE,color=continent))+
  labs(x="Year",y="Mean Life Expectancy of Each Continent",
  title="Growth of the Mean Life Expectancy of Each Continent (Original)")+
  theme_light()
```
  
The x axis in the reshaped data is the continents and it was difficult to add scales and label the axis properly. Coding for the plots is much easier for the original data , it is more visually appealing, and the trends are more apparent. Hence, comparing the original and the reshaped plots suggests that plotting the original data is simpler, neater and more understandable. 

3. Re-lengthen the data.
```{r}
t1_wide %>% 
  pivot_longer(cols = c(-year), 
               names_to  = "Continent", 
               values_to = "Mean Life Expectancy") %>% 
  knitr::kable() %>% 
    kable_styling("striped",latex_options="basic",
      full_width=FALSE, position="center")

```


# Exercise 2: Multivariate Data Reshaping
Choose *EITHER* “Multivariate Option 1” or “Multivariate Option 2”. All of these problems have two components:

1. Putting data in wider format
2. Re-lengthening the data

### **Multivariate Option 1**
1. Make a tibble with one row per year, and columns for life expectancy and GDP per capita (or two other numeric variables) for two or more countries.

```{r}
t2<-gapminder %>% 
    select(year,country,lifeExp,gdpPercap) %>% 
    filter(country=="Canada"|country=="Japan") %>% 
    group_by(year) %>% 
  pivot_wider(names_from="country",names_sep="_",
     values_from=c("lifeExp","gdpPercap"))

  knitr::kable(t2) %>% 
  kable_styling("striped",latex_options = "basic",
    full_width = FALSE,position="center")
```

2. Re-lengthen the data.

```{r}
t2_longer<-t2 %>% 
pivot_longer(cols=c(-year),names_to=c("Variable","Country"),names_sep="_")

knitr::kable(t2_longer) %>% 
  kable_styling("striped",latex_options = "basic",
    full_width = FALSE,position="center")
```


### ~~Multivariate Option 2~~
1. Compute some measure of life expectancy and GDP per capita (or two other numeric variables) (mean? median? min? max?) for all possible combinations of continent and year. Reshape that to have one row per year and one variable for each continent-measurement combination. Or the other way around: one row per continent and one variable for each year-measurement combination. 
2.Re-lengthen the data.

# Exercise 3: Table Joins
Do *ALL* of the activities in this section.

Read in the made-up wedding guestlist and email addresses using the following lines (go ahead and copy-paste these):

guest <- [read_csv link]("https://raw.githubusercontent.com/STAT545-UBC/Classroom/master/data/wedding/attend.csv")

email <- [read_csv link]("https://raw.githubusercontent.com/STAT545-UBC/Classroom/master/data/wedding/emails.csv")

Then, complete the following tasks using the tidyverse (tidyr, dplyr, …). No need to do any pivoting – feel free to leave guest in its current format.

### 3.1 Add emails
For each guest in the guestlist (guest tibble), add a column for email address, which can be found in the email tibble.

### 3.2 Filter emails
Who do we have emails for, yet are not on the guestlist?

### 3.3 Make a guestlist
Make a guestlist that includes everyone we have emails for (in addition to those on the original guestlist).




